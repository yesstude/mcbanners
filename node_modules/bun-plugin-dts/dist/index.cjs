var X=Object.create;var{getPrototypeOf:Y,defineProperty:_,getOwnPropertyNames:H,getOwnPropertyDescriptor:Z}=Object,I=Object.prototype.hasOwnProperty;var w=(A,c,E)=>{E=A!=null?X(Y(A)):{};const R=c||!A||!A.__esModule?_(E,"default",{value:A,enumerable:!0}):E;for(let S of H(A))if(!I.call(R,S))_(R,S,{get:()=>A[S],enumerable:!0});return R},G=new WeakMap,$=(A)=>{var c=G.get(A),E;if(c)return c;if(c=_({},"__esModule",{value:!0}),A&&typeof A==="object"||typeof A==="function")H(A).map((R)=>!I.call(c,R)&&_(c,R,{get:()=>A[R],enumerable:!(E=Z(A,R))||E.enumerable}));return G.set(A,c),c},f=(A,c)=>()=>(c||A((c={exports:{}}).exports,c),c.exports);var B=(A,c)=>{for(var E in c)_(A,E,{get:c[E],enumerable:!0,configurable:!0,set:(R)=>c[E]=()=>R})};var K=f((b,J)=>{var{sep:P}=require("path"),h=(A)=>{for(let c of A){const E=/(\/|\\)/.exec(c);if(E!==null)return E[0]}return P};J.exports=function A(c,E=h(c)){const[R="",...S]=c;if(R===""||S.length===0)return"";const T=R.split(E);let q=T.length;for(let W of S){const L=W.split(E);for(let j=0;j<q;j++)if(L[j]!==T[j])q=j;if(q===0)return""}const U=T.slice(0,q).join(E);return U.endsWith(E)?U:U+E}});var x={};B(x,{default:()=>a});module.exports=$(x);var k=w(require("node:fs")),v=w(require("node:path")),M=require("dts-bundle-generator"),N=require("get-tsconfig"),O=w(K()),r=(A)=>{return{name:"bun-plugin-dts",async setup(c){const{compilationOptions:E,...R}=A||{},S=[...c.config.entrypoints].sort(),T=S.map((j)=>{return{filePath:j,...R}}),q=E?.preferredConfigPath??N.getTsconfig()?.path,U=M.generateDtsBundle(T,{...E,preferredConfigPath:q}),W=c.config.outdir||"./dist";if(!k.default.existsSync(W))k.default.mkdirSync(W,{recursive:!0});let L=O.default(S);if(!L||L===process.cwd())L=v.default.dirname(S[0]);await Promise.all(S.map((j,Q)=>{const V=v.default.relative(L,j).replace(/\.[jtm]s$/,".d.ts"),z=v.default.join(W,V),C=v.default.dirname(z);if(!k.default.existsSync(C))k.default.mkdirSync(C,{recursive:!0});return Bun.write(z,U[Q])}))}}},a=r;
